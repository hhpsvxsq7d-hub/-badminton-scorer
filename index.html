<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Badminton Scorer</title>

<style>
* { box-sizing: border-box; }
body {
  margin: 0;
  background: #000;
  color: #fff;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  height: 100vh;
  display: flex;
  flex-direction: column;
}
.top {
  height: 56px;
  background: #111;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 12px;
  border-bottom: 1px solid #333;
}
button {
  background: #222;
  color: #fff;
  border: 1px solid #444;
  padding: 6px 10px;
  border-radius: 6px;
  font-weight: 700;
}
button.danger { color: #f87171; }
.main {
  flex: 1;
  display: flex;
}
.side {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  border-right: 1px solid #333;
}
.side:last-child { border-right: none; }
.name {
  background: transparent;
  border: none;
  border-bottom: 1px solid #444;
  color: #aaa;
  font-size: 18px;
  font-weight: 700;
  text-align: center;
  margin-bottom: 12px;
}
.score {
  font-size: 30vw;
  font-weight: 900;
  line-height: 0.8;
}
.courts {
  display: flex;
  gap: 10px;
  width: 100%;
  padding: 0 20px;
  margin-top: 16px;
}
.court {
  flex: 1;
  border: 2px solid #333;
  border-radius: 12px;
  padding: 14px 0;
  text-align: center;
  color: #666;
  font-weight: 700;
}
.server {
  border-color: #facc15;
  color: #facc15;
  box-shadow: 0 0 25px rgba(250,204,21,0.4);
}
</style>
</head>

<body>

<div class="top">
  <div>
    <button onclick="toggleMode()" id="modeBtn">é›™æ‰“æ¨¡å¼</button>
    <button onclick="switchSides()">ğŸ”„ æ›é‚Š</button>
  </div>
  <div>
    <button onclick="undo()">â†© å¾©åŸ</button>
    <button class="danger" onclick="resetGame()">é‡è¨­</button>
  </div>
</div>

<div class="main">
  <div class="side" onclick="addPoint('left')">
    <input class="name" id="nameLeft" value="TEAM A" onclick="event.stopPropagation()">
    <div class="score" id="scoreLeft">0</div>
    <div class="courts">
      <div class="court" id="left-L">å·¦å€</div>
      <div class="court" id="left-R">å³å€</div>
    </div>
  </div>

  <div class="side" onclick="addPoint('right')">
    <input class="name" id="nameRight" value="TEAM B" onclick="event.stopPropagation()">
    <div class="score" id="scoreRight">0</div>
    <div class="courts">
      <div class="court" id="right-R">å³å€</div>
      <div class="court" id="right-L">å·¦å€</div>
    </div>
  </div>
</div>

<script>
let state = {
  left: 0,
  right: 0,
  server: 'left',
  mode: 'doubles',
  history: []
};

function save() {
  state.history.push(JSON.stringify(state));
}

function isGame() {
  return (state.left >= 21 || state.right >= 21) &&
         Math.abs(state.left - state.right) >= 2;
}

function update() {
  scoreLeft.textContent = state.left;
  scoreRight.textContent = state.right;
  modeBtn.textContent = state.mode === 'doubles' ? 'é›™æ‰“æ¨¡å¼' : 'å–®æ‰“æ¨¡å¼';

  ['left-L','left-R','right-L','right-R'].forEach(id => {
    const el = document.getElementById(id);
    el.className = 'court';
    el.textContent = id.includes('L') ? 'å·¦å€' : 'å³å€';
  });

  if (isGame()) {
    (state.left > state.right ? scoreLeft : scoreRight).textContent = 'GAME';
    return;
  }

  const score = state.server === 'left' ? state.left : state.right;
  const side = score % 2 === 0 ? 'R' : 'L';
  document.getElementById(`${state.server}-${side}`).classList.add('server');
}

function addPoint(side) {
  if (isGame()) return;
  save();
  state[side]++;
  state.server = side;
  update();
}

function undo() {
  if (!state.history.length) return;
  state = JSON.parse(state.history.pop());
  update();
}

function resetGame() {
  if (!confirm('ç¢ºå®šé‡è¨­ï¼Ÿ')) return;
  state.left = 0;
  state.right = 0;
  state.server = 'left';
  state.history = [];
  update();
}

function toggleMode() {
  state.mode = state.mode === 'doubles' ? 'singles' : 'doubles';
  update();
}

function switchSides() {
  save();
  [state.left, state.right] = [state.right, state.left];
  [nameLeft.value, nameRight.value] = [nameRight.value, nameLeft.value];
  state.server = state.server === 'left' ? 'right' : 'left';
  update();
}

update();
</script>

</body>
</html>
